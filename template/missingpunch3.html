<!doctype html>
<html lang="en" xmlns:pdf="http://ns.adobe.com/pdf/1.3/">
  <head>
    <meta charset="utf-8">
    <title>Missing Punch Final Warning</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% set brand = brand if brand is defined else ('TERRA' if store and store|lower == 'terra' else 'BTRUST') %}
    <style>
      /* Letter-style layout for cleaner PDF output */
      body {
        margin: 0;
        padding: 0;
        background-color: transparent;
        position: relative;
      }
      .container { max-width: 700px; margin: 0 auto; font-family: Arial, Helvetica, sans-serif; color: #111827; position: relative; z-index: 2; }
      .card { padding: 24px; position: relative; z-index: 2; }
      p { line-height: 1.6; font-size: 14px; margin: 12px 0; text-align: justify; }
      .signature-line { margin: 24px 0; }
      .divider { margin: 28px 0 16px; border: 0; border-top: 1px solid #d1d5db; }
      h1 { font-size: 20px; margin: 0 0 12px 0; }
      .logo-header { position: absolute; top: 0; left: 0; padding: 12px; z-index: 3; }
    </style>
  </head>
  <body>
    {% if logo_path %}
    {% set logo_src = logo_path %}
    {% elif templateDIR %}
    {% set logo_src = templateDIR ~ '/logoHQ.png' %}
    {% else %}
    {% set logo_src = 'logoHQ.png' %}
    {% endif %}
    <div class="logo-header">
      <img src="{{ logo_src }}" alt="Company logo" style="width:120px; height:auto; object-fit:contain;" />
    </div>
    <div class="container" style="padding: 96px 24px 24px 24px;">
      <div class="card" style="background:transparent;">
        <div style="margin-bottom:18px;">
          <p style="margin:4px 0; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;">Private & Confidential</p>
          <p style="margin:4px 0;">Date: {{ snap_time.strftime('%B %d, %Y') if snap_time else '' }}</p>
          <p style="margin:4px 0;">Employee Name: {{ name or incidents[0].get('RealName') if incidents else '' }}</p>
          <p style="margin:4px 0;">Employee No.: {{ incidents[0].get('BtrustID') if incidents else '' }}</p>
          <p style="margin:4px 0;">Department: {{ department or incidents[0].get('Department') if incidents else '' }}</p>
          <p style="margin:8px 0 0 0; font-weight:700;">Re: Missing Punch - Final Warning</p>
        </div>
        <p>Dear <strong>{{ name }}</strong>,</p>

        <p>
          This letter serves as a final warning regarding repeated missing punches (excluding verified technical issues)
          occurring more than three times within the last month. Such occurrences constitute a serious violation of company policy.
        </p>

        <p>
          You are required to demonstrate immediate and consistent improvement. Failure to do so may result in further
          disciplinary action, up to and including termination of employment.
        </p>

        <p>
          If you have any concerns or require support, please discuss them with your direct/store manager.
        </p>

        <p>
          Yours truly,<br/><br/>
          For and on behalf of <strong>{{ brand }}</strong><br/>
          <strong>Marica LEE</strong><br/>
          Human Resources Director
        </p>

        <hr class="divider" />

        <h1>Acknowledgment</h1>
        <p>
          I, <strong>{{ name }}</strong>, acknowledge receipt of this Final Warning letter.
        </p>

        <div class="signature-line">
          <p>Employee Signature</p>
          <p>___________________________</p>
        </div>
      </div>
    </div>
  </body>
</html>
